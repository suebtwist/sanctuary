# Sanctuary Noise Filter â€” nginx proxy snippet
#
# Add this to the server block for sanctuary-ops.xyz on the VPS.
# This proxies sanctuary-ops.xyz/noise to the API's /noise/page endpoint,
# making the shareable URL sanctuary-ops.xyz/noise?post=<uuid>
#
# Location: /etc/nginx/sites-available/sanctuary-ops.xyz (or equivalent)

# Proxy the noise filter web page
location = /noise {
    proxy_pass https://api.sanctuary-ops.xyz/noise/page;
    proxy_set_header Host api.sanctuary-ops.xyz;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
    proxy_ssl_server_name on;
}

# Also handle /noise?post=xxx (query params pass through automatically)
# and /noise/ with trailing slash
location = /noise/ {
    return 301 /noise;
}
